{"ast":null,"code":"var _jsxFileName = \"/Users/liuyanjun/therapy_agent/frontend/src/Login.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useRef, useEffect } from 'react';\nimport axios from 'axios';\nimport './Login.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Login = ({\n  onLogin,\n  onRegister\n}) => {\n  _s();\n\n  const [isLogin, setIsLogin] = useState(true);\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [email, setEmail] = useState('');\n  const [error, setError] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [showPassword, setShowPassword] = useState(false);\n  const [rememberMe, setRememberMe] = useState(false);\n  const apiBaseUrl = process.env.REACT_APP_API_BASE_URL || 'http://localhost:5001';\n  const usernameRef = useRef(null); // 自动聚焦用户名输入框\n\n  useEffect(() => {\n    if (usernameRef.current) {\n      usernameRef.current.focus();\n    }\n  }, []); // 检查本地存储中的记住用户名\n\n  useEffect(() => {\n    const savedUsername = localStorage.getItem('rememberedUsername');\n\n    if (savedUsername) {\n      setUsername(savedUsername);\n      setRememberMe(true);\n    }\n  }, []); // 表单验证\n\n  const validateForm = () => {\n    if (!username.trim()) {\n      setError('请输入用户名');\n      return false;\n    }\n\n    if (!password) {\n      setError('请输入密码');\n      return false;\n    }\n\n    if (!isLogin && email && !/\\S+@\\S+\\.\\S+/.test(email)) {\n      setError('请输入有效的邮箱地址');\n      return false;\n    }\n\n    return true;\n  };\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n    setError('');\n    if (!validateForm()) return;\n    setLoading(true);\n\n    try {\n      if (isLogin) {\n        // 登录逻辑\n        const response = await axios.post(`${apiBaseUrl}/api/login`, {\n          user_info: {\n            username,\n            password\n          }\n        });\n\n        if (response.data.success && response.data.validID) {\n          // 处理记住我功能\n          if (rememberMe) {\n            localStorage.setItem('rememberedUsername', username);\n          } else {\n            localStorage.removeItem('rememberedUsername');\n          }\n\n          onLogin({\n            userID: response.data.userID,\n            sessionID: response.data.sessionID,\n            token: response.data.token,\n            username: username,\n            model_prompt: response.data.model_prompt,\n            choices: response.data.choices\n          });\n        } else {\n          setError(response.data.error || '登录失败');\n        }\n      } else {\n        // 注册逻辑\n        const response = await axios.post(`${apiBaseUrl}/api/register`, {\n          user_info: {\n            username,\n            password,\n            email\n          }\n        });\n\n        if (response.data.success) {\n          // 自动登录\n          const loginResponse = await axios.post(`${apiBaseUrl}/api/login`, {\n            user_info: {\n              username,\n              password\n            }\n          });\n\n          if (loginResponse.data.success && loginResponse.data.validID) {\n            onRegister({\n              userID: loginResponse.data.userID,\n              sessionID: loginResponse.data.sessionID,\n              token: loginResponse.data.token,\n              username: username\n            });\n          }\n        } else {\n          setError(response.data.error || '注册失败');\n        }\n      }\n    } catch (error) {\n      var _error$response, _error$response$data;\n\n      console.error('Authentication error:', error);\n      setError(((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.error) || '网络错误，请稍后重试');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleInputChange = (field, value) => {\n    // 清除错误信息\n    if (error) setError('');\n\n    switch (field) {\n      case 'username':\n        setUsername(value);\n        break;\n\n      case 'password':\n        setPassword(value);\n        break;\n\n      case 'email':\n        setEmail(value);\n        break;\n\n      default:\n        break;\n    }\n  };\n\n  const togglePasswordVisibility = () => {\n    setShowPassword(!showPassword);\n  };\n\n  const switchMode = () => {\n    setIsLogin(!isLogin);\n    setError('');\n    setUsername('');\n    setPassword('');\n    setEmail('');\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"login-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"background-shapes\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"shape shape-1\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"shape shape-2\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"shape shape-3\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"shape shape-4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"shape shape-5\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"login-form\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"brand-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"brand-icon\",\n          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n            viewBox: \"0 0 24 24\",\n            fill: \"none\",\n            xmlns: \"http://www.w3.org/2000/svg\",\n            children: [/*#__PURE__*/_jsxDEV(\"path\", {\n              d: \"M12 2L2 7V12C2 16.5 4.23 20.68 12 22C19.77 20.68 22 16.5 22 12V7L12 2Z\",\n              stroke: \"currentColor\",\n              strokeWidth: \"2\",\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 164,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n              d: \"M12 8V16\",\n              stroke: \"currentColor\",\n              strokeWidth: \"2\",\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 165,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n              d: \"M8 12H16\",\n              stroke: \"currentColor\",\n              strokeWidth: \"2\",\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 166,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 163,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"brand-title\",\n          children: \"MindGuide\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"brand-subtitle\",\n          children: \"\\u60A8\\u7684\\u5FC3\\u7075\\u5065\\u5EB7\\u4F19\\u4F34\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit,\n        className: \"form-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"form-title\",\n          children: isLogin ? '欢迎回来' : '加入我们'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"form-subtitle\",\n          children: isLogin ? '登录您的账户继续治疗之旅' : '创建账户开始您的心灵疗愈'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 11\n        }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"error-message\",\n          children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n            className: \"error-icon\",\n            viewBox: \"0 0 20 20\",\n            fill: \"currentColor\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              fillRule: \"evenodd\",\n              d: \"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z\",\n              clipRule: \"evenodd\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 185,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 184,\n            columnNumber: 15\n          }, this), error]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"username\",\n            children: \"\\u7528\\u6237\\u540D\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 192,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"input-wrapper\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              ref: usernameRef,\n              id: \"username\",\n              type: \"text\",\n              value: username,\n              onChange: e => handleInputChange('username', e.target.value),\n              placeholder: \"\\u8BF7\\u8F93\\u5165\\u7528\\u6237\\u540D\",\n              className: \"form-input\",\n              disabled: loading\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 194,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"input-icon\",\n              viewBox: \"0 0 20 20\",\n              fill: \"currentColor\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                fillRule: \"evenodd\",\n                d: \"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\",\n                clipRule: \"evenodd\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 205,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 204,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 193,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"password\",\n            children: \"\\u5BC6\\u7801\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 211,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"input-wrapper\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              id: \"password\",\n              type: showPassword ? \"text\" : \"password\",\n              value: password,\n              onChange: e => handleInputChange('password', e.target.value),\n              placeholder: \"\\u8BF7\\u8F93\\u5165\\u5BC6\\u7801\",\n              className: \"form-input\",\n              disabled: loading\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 213,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"input-icon\",\n              viewBox: \"0 0 20 20\",\n              fill: \"currentColor\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                fillRule: \"evenodd\",\n                d: \"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z\",\n                clipRule: \"evenodd\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 223,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 222,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: \"password-toggle\",\n              onClick: togglePasswordVisibility,\n              disabled: loading,\n              children: showPassword ? /*#__PURE__*/_jsxDEV(\"svg\", {\n                viewBox: \"0 0 20 20\",\n                fill: \"currentColor\",\n                children: [/*#__PURE__*/_jsxDEV(\"path\", {\n                  d: \"M10 12a2 2 0 100-4 2 2 0 000 4z\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 233,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n                  fillRule: \"evenodd\",\n                  d: \"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z\",\n                  clipRule: \"evenodd\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 234,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 232,\n                columnNumber: 19\n              }, this) : /*#__PURE__*/_jsxDEV(\"svg\", {\n                viewBox: \"0 0 20 20\",\n                fill: \"currentColor\",\n                children: [/*#__PURE__*/_jsxDEV(\"path\", {\n                  fillRule: \"evenodd\",\n                  d: \"M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-4.512 1.074l-1.78-1.781zm4.261 4.26l1.514 1.515a2.003 2.003 0 012.45 2.45l1.514 1.514a4 4 0 00-5.478-5.478z\",\n                  clipRule: \"evenodd\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 238,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n                  d: \"M12.454 16.697L9.75 13.992a4 4 0 01-3.742-3.741L2.335 6.578A9.98 9.98 0 00.458 10c1.274 4.057 5.065 7 9.542 7 .847 0 1.669-.105 2.454-.303z\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 239,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 237,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 225,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 212,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 11\n        }, this), !isLogin && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"email\",\n            children: \"\\u90AE\\u7BB1 (\\u53EF\\u9009)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 248,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"input-wrapper\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              id: \"email\",\n              type: \"email\",\n              value: email,\n              onChange: e => handleInputChange('email', e.target.value),\n              placeholder: \"\\u8BF7\\u8F93\\u5165\\u90AE\\u7BB1\",\n              className: \"form-input\",\n              disabled: loading\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 250,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"input-icon\",\n              viewBox: \"0 0 20 20\",\n              fill: \"currentColor\",\n              children: [/*#__PURE__*/_jsxDEV(\"path\", {\n                d: \"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 260,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n                d: \"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 261,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 259,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 249,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 247,\n          columnNumber: 13\n        }, this), isLogin && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-options\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"checkbox-label\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"checkbox\",\n              checked: rememberMe,\n              onChange: e => setRememberMe(e.target.checked),\n              disabled: loading\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 270,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"checkbox-text\",\n              children: \"\\u8BB0\\u4F4F\\u6211\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 276,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 269,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n            href: \"#\",\n            className: \"forgot-link\",\n            children: \"\\u5FD8\\u8BB0\\u5BC6\\u7801\\uFF1F\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 278,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 268,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          disabled: loading,\n          className: \"submit-btn\",\n          children: loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"loading-spinner\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"spinner\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 289,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"\\u5904\\u7406\\u4E2D...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 290,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 288,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n            children: isLogin ? '登录' : '注册'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 293,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 282,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"switch-mode\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [isLogin ? '还没有账号？' : '已有账号？', /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            className: \"switch-btn\",\n            onClick: switchMode,\n            disabled: loading,\n            children: isLogin ? '立即注册' : '立即登录'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 302,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 300,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 299,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"demo-info\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"\\u6F14\\u793A\\u8D26\\u53F7\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"demo-accounts\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"demo-account\",\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u7528\\u6237\\u540D:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 318,\n              columnNumber: 15\n            }, this), \" user1\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 319,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u5BC6\\u7801:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 320,\n              columnNumber: 15\n            }, this), \" ph6n76gec9\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 317,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"demo-account\",\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u7528\\u6237\\u540D:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 323,\n              columnNumber: 15\n            }, this), \" user2\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 324,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u5BC6\\u7801:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 325,\n              columnNumber: 15\n            }, this), \" ph6n76gec9\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 322,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 316,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"demo-note\",\n          children: \"\\u53EF\\u4F7F\\u7528 user1 \\u5230 user30 \\u7684\\u4EFB\\u610F\\u8D26\\u53F7\\u8FDB\\u884C\\u6D4B\\u8BD5\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 328,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 314,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 149,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Login, \"Ek2+t//KMKrd35hfnl5ygr/+5Dg=\");\n\n_c = Login;\nexport default Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["/Users/liuyanjun/therapy_agent/frontend/src/Login.js"],"names":["React","useState","useRef","useEffect","axios","Login","onLogin","onRegister","isLogin","setIsLogin","username","setUsername","password","setPassword","email","setEmail","error","setError","loading","setLoading","showPassword","setShowPassword","rememberMe","setRememberMe","apiBaseUrl","process","env","REACT_APP_API_BASE_URL","usernameRef","current","focus","savedUsername","localStorage","getItem","validateForm","trim","test","handleSubmit","e","preventDefault","response","post","user_info","data","success","validID","setItem","removeItem","userID","sessionID","token","model_prompt","choices","loginResponse","console","handleInputChange","field","value","togglePasswordVisibility","switchMode","target","checked"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,MAA1B,EAAkCC,SAAlC,QAAmD,OAAnD;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAO,aAAP;;;AAEA,MAAMC,KAAK,GAAG,CAAC;AAAEC,EAAAA,OAAF;AAAWC,EAAAA;AAAX,CAAD,KAA6B;AAAA;;AACzC,QAAM,CAACC,OAAD,EAAUC,UAAV,IAAwBR,QAAQ,CAAC,IAAD,CAAtC;AACA,QAAM,CAACS,QAAD,EAAWC,WAAX,IAA0BV,QAAQ,CAAC,EAAD,CAAxC;AACA,QAAM,CAACW,QAAD,EAAWC,WAAX,IAA0BZ,QAAQ,CAAC,EAAD,CAAxC;AACA,QAAM,CAACa,KAAD,EAAQC,QAAR,IAAoBd,QAAQ,CAAC,EAAD,CAAlC;AACA,QAAM,CAACe,KAAD,EAAQC,QAAR,IAAoBhB,QAAQ,CAAC,EAAD,CAAlC;AACA,QAAM,CAACiB,OAAD,EAAUC,UAAV,IAAwBlB,QAAQ,CAAC,KAAD,CAAtC;AACA,QAAM,CAACmB,YAAD,EAAeC,eAAf,IAAkCpB,QAAQ,CAAC,KAAD,CAAhD;AACA,QAAM,CAACqB,UAAD,EAAaC,aAAb,IAA8BtB,QAAQ,CAAC,KAAD,CAA5C;AAEA,QAAMuB,UAAU,GAAGC,OAAO,CAACC,GAAR,CAAYC,sBAAZ,IAAsC,uBAAzD;AACA,QAAMC,WAAW,GAAG1B,MAAM,CAAC,IAAD,CAA1B,CAXyC,CAazC;;AACAC,EAAAA,SAAS,CAAC,MAAM;AACd,QAAIyB,WAAW,CAACC,OAAhB,EAAyB;AACvBD,MAAAA,WAAW,CAACC,OAAZ,CAAoBC,KAApB;AACD;AACF,GAJQ,EAIN,EAJM,CAAT,CAdyC,CAoBzC;;AACA3B,EAAAA,SAAS,CAAC,MAAM;AACd,UAAM4B,aAAa,GAAGC,YAAY,CAACC,OAAb,CAAqB,oBAArB,CAAtB;;AACA,QAAIF,aAAJ,EAAmB;AACjBpB,MAAAA,WAAW,CAACoB,aAAD,CAAX;AACAR,MAAAA,aAAa,CAAC,IAAD,CAAb;AACD;AACF,GANQ,EAMN,EANM,CAAT,CArByC,CA6BzC;;AACA,QAAMW,YAAY,GAAG,MAAM;AACzB,QAAI,CAACxB,QAAQ,CAACyB,IAAT,EAAL,EAAsB;AACpBlB,MAAAA,QAAQ,CAAC,QAAD,CAAR;AACA,aAAO,KAAP;AACD;;AACD,QAAI,CAACL,QAAL,EAAe;AACbK,MAAAA,QAAQ,CAAC,OAAD,CAAR;AACA,aAAO,KAAP;AACD;;AACD,QAAI,CAACT,OAAD,IAAYM,KAAZ,IAAqB,CAAC,eAAesB,IAAf,CAAoBtB,KAApB,CAA1B,EAAsD;AACpDG,MAAAA,QAAQ,CAAC,YAAD,CAAR;AACA,aAAO,KAAP;AACD;;AACD,WAAO,IAAP;AACD,GAdD;;AAgBA,QAAMoB,YAAY,GAAG,MAAOC,CAAP,IAAa;AAChCA,IAAAA,CAAC,CAACC,cAAF;AACAtB,IAAAA,QAAQ,CAAC,EAAD,CAAR;AAEA,QAAI,CAACiB,YAAY,EAAjB,EAAqB;AAErBf,IAAAA,UAAU,CAAC,IAAD,CAAV;;AAEA,QAAI;AACF,UAAIX,OAAJ,EAAa;AACX;AACA,cAAMgC,QAAQ,GAAG,MAAMpC,KAAK,CAACqC,IAAN,CAAY,GAAEjB,UAAW,YAAzB,EAAsC;AAC3DkB,UAAAA,SAAS,EAAE;AAAEhC,YAAAA,QAAF;AAAYE,YAAAA;AAAZ;AADgD,SAAtC,CAAvB;;AAIA,YAAI4B,QAAQ,CAACG,IAAT,CAAcC,OAAd,IAAyBJ,QAAQ,CAACG,IAAT,CAAcE,OAA3C,EAAoD;AAClD;AACA,cAAIvB,UAAJ,EAAgB;AACdU,YAAAA,YAAY,CAACc,OAAb,CAAqB,oBAArB,EAA2CpC,QAA3C;AACD,WAFD,MAEO;AACLsB,YAAAA,YAAY,CAACe,UAAb,CAAwB,oBAAxB;AACD;;AAEDzC,UAAAA,OAAO,CAAC;AACN0C,YAAAA,MAAM,EAAER,QAAQ,CAACG,IAAT,CAAcK,MADhB;AAENC,YAAAA,SAAS,EAAET,QAAQ,CAACG,IAAT,CAAcM,SAFnB;AAGNC,YAAAA,KAAK,EAAEV,QAAQ,CAACG,IAAT,CAAcO,KAHf;AAINxC,YAAAA,QAAQ,EAAEA,QAJJ;AAKNyC,YAAAA,YAAY,EAAEX,QAAQ,CAACG,IAAT,CAAcQ,YALtB;AAMNC,YAAAA,OAAO,EAAEZ,QAAQ,CAACG,IAAT,CAAcS;AANjB,WAAD,CAAP;AAQD,SAhBD,MAgBO;AACLnC,UAAAA,QAAQ,CAACuB,QAAQ,CAACG,IAAT,CAAc3B,KAAd,IAAuB,MAAxB,CAAR;AACD;AACF,OAzBD,MAyBO;AACL;AACA,cAAMwB,QAAQ,GAAG,MAAMpC,KAAK,CAACqC,IAAN,CAAY,GAAEjB,UAAW,eAAzB,EAAyC;AAC9DkB,UAAAA,SAAS,EAAE;AAAEhC,YAAAA,QAAF;AAAYE,YAAAA,QAAZ;AAAsBE,YAAAA;AAAtB;AADmD,SAAzC,CAAvB;;AAIA,YAAI0B,QAAQ,CAACG,IAAT,CAAcC,OAAlB,EAA2B;AACzB;AACA,gBAAMS,aAAa,GAAG,MAAMjD,KAAK,CAACqC,IAAN,CAAY,GAAEjB,UAAW,YAAzB,EAAsC;AAChEkB,YAAAA,SAAS,EAAE;AAAEhC,cAAAA,QAAF;AAAYE,cAAAA;AAAZ;AADqD,WAAtC,CAA5B;;AAIA,cAAIyC,aAAa,CAACV,IAAd,CAAmBC,OAAnB,IAA8BS,aAAa,CAACV,IAAd,CAAmBE,OAArD,EAA8D;AAC5DtC,YAAAA,UAAU,CAAC;AACTyC,cAAAA,MAAM,EAAEK,aAAa,CAACV,IAAd,CAAmBK,MADlB;AAETC,cAAAA,SAAS,EAAEI,aAAa,CAACV,IAAd,CAAmBM,SAFrB;AAGTC,cAAAA,KAAK,EAAEG,aAAa,CAACV,IAAd,CAAmBO,KAHjB;AAITxC,cAAAA,QAAQ,EAAEA;AAJD,aAAD,CAAV;AAMD;AACF,SAdD,MAcO;AACLO,UAAAA,QAAQ,CAACuB,QAAQ,CAACG,IAAT,CAAc3B,KAAd,IAAuB,MAAxB,CAAR;AACD;AACF;AACF,KAlDD,CAkDE,OAAOA,KAAP,EAAc;AAAA;;AACdsC,MAAAA,OAAO,CAACtC,KAAR,CAAc,uBAAd,EAAuCA,KAAvC;AACAC,MAAAA,QAAQ,CAAC,oBAAAD,KAAK,CAACwB,QAAN,4FAAgBG,IAAhB,8EAAsB3B,KAAtB,KAA+B,YAAhC,CAAR;AACD,KArDD,SAqDU;AACRG,MAAAA,UAAU,CAAC,KAAD,CAAV;AACD;AACF,GAhED;;AAkEA,QAAMoC,iBAAiB,GAAG,CAACC,KAAD,EAAQC,KAAR,KAAkB;AAC1C;AACA,QAAIzC,KAAJ,EAAWC,QAAQ,CAAC,EAAD,CAAR;;AAEX,YAAQuC,KAAR;AACE,WAAK,UAAL;AACE7C,QAAAA,WAAW,CAAC8C,KAAD,CAAX;AACA;;AACF,WAAK,UAAL;AACE5C,QAAAA,WAAW,CAAC4C,KAAD,CAAX;AACA;;AACF,WAAK,OAAL;AACE1C,QAAAA,QAAQ,CAAC0C,KAAD,CAAR;AACA;;AACF;AACE;AAXJ;AAaD,GAjBD;;AAmBA,QAAMC,wBAAwB,GAAG,MAAM;AACrCrC,IAAAA,eAAe,CAAC,CAACD,YAAF,CAAf;AACD,GAFD;;AAIA,QAAMuC,UAAU,GAAG,MAAM;AACvBlD,IAAAA,UAAU,CAAC,CAACD,OAAF,CAAV;AACAS,IAAAA,QAAQ,CAAC,EAAD,CAAR;AACAN,IAAAA,WAAW,CAAC,EAAD,CAAX;AACAE,IAAAA,WAAW,CAAC,EAAD,CAAX;AACAE,IAAAA,QAAQ,CAAC,EAAD,CAAR;AACD,GAND;;AAQA,sBACE;AAAK,IAAA,SAAS,EAAC,iBAAf;AAAA,4BAEE;AAAK,MAAA,SAAS,EAAC,mBAAf;AAAA,8BACE;AAAK,QAAA,SAAS,EAAC;AAAf;AAAA;AAAA;AAAA;AAAA,cADF,eAEE;AAAK,QAAA,SAAS,EAAC;AAAf;AAAA;AAAA;AAAA;AAAA,cAFF,eAGE;AAAK,QAAA,SAAS,EAAC;AAAf;AAAA;AAAA;AAAA;AAAA,cAHF,eAIE;AAAK,QAAA,SAAS,EAAC;AAAf;AAAA;AAAA;AAAA;AAAA,cAJF,eAKE;AAAK,QAAA,SAAS,EAAC;AAAf;AAAA;AAAA;AAAA;AAAA,cALF;AAAA;AAAA;AAAA;AAAA;AAAA,YAFF,eAUE;AAAK,MAAA,SAAS,EAAC,YAAf;AAAA,8BAEE;AAAK,QAAA,SAAS,EAAC,cAAf;AAAA,gCACE;AAAK,UAAA,SAAS,EAAC,YAAf;AAAA,iCACE;AAAK,YAAA,OAAO,EAAC,WAAb;AAAyB,YAAA,IAAI,EAAC,MAA9B;AAAqC,YAAA,KAAK,EAAC,4BAA3C;AAAA,oCACE;AAAM,cAAA,CAAC,EAAC,wEAAR;AAAiF,cAAA,MAAM,EAAC,cAAxF;AAAuG,cAAA,WAAW,EAAC,GAAnH;AAAuH,cAAA,aAAa,EAAC,OAArI;AAA6I,cAAA,cAAc,EAAC;AAA5J;AAAA;AAAA;AAAA;AAAA,oBADF,eAEE;AAAM,cAAA,CAAC,EAAC,UAAR;AAAmB,cAAA,MAAM,EAAC,cAA1B;AAAyC,cAAA,WAAW,EAAC,GAArD;AAAyD,cAAA,aAAa,EAAC,OAAvE;AAA+E,cAAA,cAAc,EAAC;AAA9F;AAAA;AAAA;AAAA;AAAA,oBAFF,eAGE;AAAM,cAAA,CAAC,EAAC,UAAR;AAAmB,cAAA,MAAM,EAAC,cAA1B;AAAyC,cAAA,WAAW,EAAC,GAArD;AAAyD,cAAA,aAAa,EAAC,OAAvE;AAA+E,cAAA,cAAc,EAAC;AAA9F;AAAA;AAAA;AAAA;AAAA,oBAHF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBADF,eAQE;AAAI,UAAA,SAAS,EAAC,aAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBARF,eASE;AAAG,UAAA,SAAS,EAAC,gBAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBATF;AAAA;AAAA;AAAA;AAAA;AAAA,cAFF,eAeE;AAAM,QAAA,QAAQ,EAAEsB,YAAhB;AAA8B,QAAA,SAAS,EAAC,gBAAxC;AAAA,gCACE;AAAI,UAAA,SAAS,EAAC,YAAd;AAAA,oBACG7B,OAAO,GAAG,MAAH,GAAY;AADtB;AAAA;AAAA;AAAA;AAAA,gBADF,eAIE;AAAG,UAAA,SAAS,EAAC,eAAb;AAAA,oBACGA,OAAO,GAAG,cAAH,GAAoB;AAD9B;AAAA;AAAA;AAAA;AAAA,gBAJF,EAQGQ,KAAK,iBACJ;AAAK,UAAA,SAAS,EAAC,eAAf;AAAA,kCACE;AAAK,YAAA,SAAS,EAAC,YAAf;AAA4B,YAAA,OAAO,EAAC,WAApC;AAAgD,YAAA,IAAI,EAAC,cAArD;AAAA,mCACE;AAAM,cAAA,QAAQ,EAAC,SAAf;AAAyB,cAAA,CAAC,EAAC,mHAA3B;AAA+I,cAAA,QAAQ,EAAC;AAAxJ;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,kBADF,EAIGA,KAJH;AAAA;AAAA;AAAA;AAAA;AAAA,gBATJ,eAiBE;AAAK,UAAA,SAAS,EAAC,YAAf;AAAA,kCACE;AAAO,YAAA,OAAO,EAAC,UAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE;AAAK,YAAA,SAAS,EAAC,eAAf;AAAA,oCACE;AACE,cAAA,GAAG,EAAEY,WADP;AAEE,cAAA,EAAE,EAAC,UAFL;AAGE,cAAA,IAAI,EAAC,MAHP;AAIE,cAAA,KAAK,EAAElB,QAJT;AAKE,cAAA,QAAQ,EAAG4B,CAAD,IAAOiB,iBAAiB,CAAC,UAAD,EAAajB,CAAC,CAACsB,MAAF,CAASH,KAAtB,CALpC;AAME,cAAA,WAAW,EAAC,sCANd;AAOE,cAAA,SAAS,EAAC,YAPZ;AAQE,cAAA,QAAQ,EAAEvC;AARZ;AAAA;AAAA;AAAA;AAAA,oBADF,eAWE;AAAK,cAAA,SAAS,EAAC,YAAf;AAA4B,cAAA,OAAO,EAAC,WAApC;AAAgD,cAAA,IAAI,EAAC,cAArD;AAAA,qCACE;AAAM,gBAAA,QAAQ,EAAC,SAAf;AAAyB,gBAAA,CAAC,EAAC,qDAA3B;AAAiF,gBAAA,QAAQ,EAAC;AAA1F;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,oBAXF;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,gBAjBF,eAoCE;AAAK,UAAA,SAAS,EAAC,YAAf;AAAA,kCACE;AAAO,YAAA,OAAO,EAAC,UAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE;AAAK,YAAA,SAAS,EAAC,eAAf;AAAA,oCACE;AACE,cAAA,EAAE,EAAC,UADL;AAEE,cAAA,IAAI,EAAEE,YAAY,GAAG,MAAH,GAAY,UAFhC;AAGE,cAAA,KAAK,EAAER,QAHT;AAIE,cAAA,QAAQ,EAAG0B,CAAD,IAAOiB,iBAAiB,CAAC,UAAD,EAAajB,CAAC,CAACsB,MAAF,CAASH,KAAtB,CAJpC;AAKE,cAAA,WAAW,EAAC,gCALd;AAME,cAAA,SAAS,EAAC,YANZ;AAOE,cAAA,QAAQ,EAAEvC;AAPZ;AAAA;AAAA;AAAA;AAAA,oBADF,eAUE;AAAK,cAAA,SAAS,EAAC,YAAf;AAA4B,cAAA,OAAO,EAAC,WAApC;AAAgD,cAAA,IAAI,EAAC,cAArD;AAAA,qCACE;AAAM,gBAAA,QAAQ,EAAC,SAAf;AAAyB,gBAAA,CAAC,EAAC,wGAA3B;AAAoI,gBAAA,QAAQ,EAAC;AAA7I;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,oBAVF,eAaE;AACE,cAAA,IAAI,EAAC,QADP;AAEE,cAAA,SAAS,EAAC,iBAFZ;AAGE,cAAA,OAAO,EAAEwC,wBAHX;AAIE,cAAA,QAAQ,EAAExC,OAJZ;AAAA,wBAMGE,YAAY,gBACX;AAAK,gBAAA,OAAO,EAAC,WAAb;AAAyB,gBAAA,IAAI,EAAC,cAA9B;AAAA,wCACE;AAAM,kBAAA,CAAC,EAAC;AAAR;AAAA;AAAA;AAAA;AAAA,wBADF,eAEE;AAAM,kBAAA,QAAQ,EAAC,SAAf;AAAyB,kBAAA,CAAC,EAAC,yIAA3B;AAAqK,kBAAA,QAAQ,EAAC;AAA9K;AAAA;AAAA;AAAA;AAAA,wBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,sBADW,gBAMX;AAAK,gBAAA,OAAO,EAAC,WAAb;AAAyB,gBAAA,IAAI,EAAC,cAA9B;AAAA,wCACE;AAAM,kBAAA,QAAQ,EAAC,SAAf;AAAyB,kBAAA,CAAC,EAAC,8PAA3B;AAA0R,kBAAA,QAAQ,EAAC;AAAnS;AAAA;AAAA;AAAA;AAAA,wBADF,eAEE;AAAM,kBAAA,CAAC,EAAC;AAAR;AAAA;AAAA;AAAA;AAAA,wBAFF;AAAA;AAAA;AAAA;AAAA;AAAA;AAZJ;AAAA;AAAA;AAAA;AAAA,oBAbF;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,gBApCF,EAwEG,CAACZ,OAAD,iBACC;AAAK,UAAA,SAAS,EAAC,YAAf;AAAA,kCACE;AAAO,YAAA,OAAO,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE;AAAK,YAAA,SAAS,EAAC,eAAf;AAAA,oCACE;AACE,cAAA,EAAE,EAAC,OADL;AAEE,cAAA,IAAI,EAAC,OAFP;AAGE,cAAA,KAAK,EAAEM,KAHT;AAIE,cAAA,QAAQ,EAAGwB,CAAD,IAAOiB,iBAAiB,CAAC,OAAD,EAAUjB,CAAC,CAACsB,MAAF,CAASH,KAAnB,CAJpC;AAKE,cAAA,WAAW,EAAC,gCALd;AAME,cAAA,SAAS,EAAC,YANZ;AAOE,cAAA,QAAQ,EAAEvC;AAPZ;AAAA;AAAA;AAAA;AAAA,oBADF,eAUE;AAAK,cAAA,SAAS,EAAC,YAAf;AAA4B,cAAA,OAAO,EAAC,WAApC;AAAgD,cAAA,IAAI,EAAC,cAArD;AAAA,sCACE;AAAM,gBAAA,CAAC,EAAC;AAAR;AAAA;AAAA;AAAA;AAAA,sBADF,eAEE;AAAM,gBAAA,CAAC,EAAC;AAAR;AAAA;AAAA;AAAA;AAAA,sBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,oBAVF;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,gBAzEJ,EA6FGV,OAAO,iBACN;AAAK,UAAA,SAAS,EAAC,cAAf;AAAA,kCACE;AAAO,YAAA,SAAS,EAAC,gBAAjB;AAAA,oCACE;AACE,cAAA,IAAI,EAAC,UADP;AAEE,cAAA,OAAO,EAAEc,UAFX;AAGE,cAAA,QAAQ,EAAGgB,CAAD,IAAOf,aAAa,CAACe,CAAC,CAACsB,MAAF,CAASC,OAAV,CAHhC;AAIE,cAAA,QAAQ,EAAE3C;AAJZ;AAAA;AAAA;AAAA;AAAA,oBADF,eAOE;AAAM,cAAA,SAAS,EAAC,eAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAPF;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAUE;AAAG,YAAA,IAAI,EAAC,GAAR;AAAY,YAAA,SAAS,EAAC,aAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAVF;AAAA;AAAA;AAAA;AAAA;AAAA,gBA9FJ,eA4GE;AACE,UAAA,IAAI,EAAC,QADP;AAEE,UAAA,QAAQ,EAAEA,OAFZ;AAGE,UAAA,SAAS,EAAC,YAHZ;AAAA,oBAKGA,OAAO,gBACN;AAAK,YAAA,SAAS,EAAC,iBAAf;AAAA,oCACE;AAAK,cAAA,SAAS,EAAC;AAAf;AAAA;AAAA;AAAA;AAAA,oBADF,eAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,kBADM,gBAMN;AAAA,sBAAOV,OAAO,GAAG,IAAH,GAAU;AAAxB;AAAA;AAAA;AAAA;AAAA;AAXJ;AAAA;AAAA;AAAA;AAAA,gBA5GF;AAAA;AAAA;AAAA;AAAA;AAAA,cAfF,eA4IE;AAAK,QAAA,SAAS,EAAC,aAAf;AAAA,+BACE;AAAA,qBACGA,OAAO,GAAG,QAAH,GAAc,OADxB,eAEE;AACE,YAAA,IAAI,EAAC,QADP;AAEE,YAAA,SAAS,EAAC,YAFZ;AAGE,YAAA,OAAO,EAAEmD,UAHX;AAIE,YAAA,QAAQ,EAAEzC,OAJZ;AAAA,sBAMGV,OAAO,GAAG,MAAH,GAAY;AANtB;AAAA;AAAA;AAAA;AAAA,kBAFF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,cA5IF,eA2JE;AAAK,QAAA,SAAS,EAAC,WAAf;AAAA,gCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAEE;AAAK,UAAA,SAAS,EAAC,eAAf;AAAA,kCACE;AAAK,YAAA,SAAS,EAAC,cAAf;AAAA,oCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADF,yBAEE;AAAA;AAAA;AAAA;AAAA,oBAFF,eAGE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAHF;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAME;AAAK,YAAA,SAAS,EAAC,cAAf;AAAA,oCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADF,yBAEE;AAAA;AAAA;AAAA;AAAA,oBAFF,eAGE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAHF;AAAA;AAAA;AAAA;AAAA;AAAA,kBANF;AAAA;AAAA;AAAA;AAAA;AAAA,gBAFF,eAcE;AAAG,UAAA,SAAS,EAAC,WAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAdF;AAAA;AAAA;AAAA;AAAA;AAAA,cA3JF;AAAA;AAAA;AAAA;AAAA;AAAA,YAVF;AAAA;AAAA;AAAA;AAAA;AAAA,UADF;AA2LD,CA1UD;;GAAMH,K;;KAAAA,K;AA4UN,eAAeA,KAAf","sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport axios from 'axios';\nimport './Login.css';\n\nconst Login = ({ onLogin, onRegister }) => {\n  const [isLogin, setIsLogin] = useState(true);\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [email, setEmail] = useState('');\n  const [error, setError] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [showPassword, setShowPassword] = useState(false);\n  const [rememberMe, setRememberMe] = useState(false);\n\n  const apiBaseUrl = process.env.REACT_APP_API_BASE_URL || 'http://localhost:5001';\n  const usernameRef = useRef(null);\n\n  // 自动聚焦用户名输入框\n  useEffect(() => {\n    if (usernameRef.current) {\n      usernameRef.current.focus();\n    }\n  }, []);\n\n  // 检查本地存储中的记住用户名\n  useEffect(() => {\n    const savedUsername = localStorage.getItem('rememberedUsername');\n    if (savedUsername) {\n      setUsername(savedUsername);\n      setRememberMe(true);\n    }\n  }, []);\n\n  // 表单验证\n  const validateForm = () => {\n    if (!username.trim()) {\n      setError('请输入用户名');\n      return false;\n    }\n    if (!password) {\n      setError('请输入密码');\n      return false;\n    }\n    if (!isLogin && email && !/\\S+@\\S+\\.\\S+/.test(email)) {\n      setError('请输入有效的邮箱地址');\n      return false;\n    }\n    return true;\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setError('');\n    \n    if (!validateForm()) return;\n\n    setLoading(true);\n\n    try {\n      if (isLogin) {\n        // 登录逻辑\n        const response = await axios.post(`${apiBaseUrl}/api/login`, {\n          user_info: { username, password }\n        });\n\n        if (response.data.success && response.data.validID) {\n          // 处理记住我功能\n          if (rememberMe) {\n            localStorage.setItem('rememberedUsername', username);\n          } else {\n            localStorage.removeItem('rememberedUsername');\n          }\n\n          onLogin({\n            userID: response.data.userID,\n            sessionID: response.data.sessionID,\n            token: response.data.token,\n            username: username,\n            model_prompt: response.data.model_prompt,\n            choices: response.data.choices\n          });\n        } else {\n          setError(response.data.error || '登录失败');\n        }\n      } else {\n        // 注册逻辑\n        const response = await axios.post(`${apiBaseUrl}/api/register`, {\n          user_info: { username, password, email }\n        });\n\n        if (response.data.success) {\n          // 自动登录\n          const loginResponse = await axios.post(`${apiBaseUrl}/api/login`, {\n            user_info: { username, password }\n          });\n\n          if (loginResponse.data.success && loginResponse.data.validID) {\n            onRegister({\n              userID: loginResponse.data.userID,\n              sessionID: loginResponse.data.sessionID,\n              token: loginResponse.data.token,\n              username: username\n            });\n          }\n        } else {\n          setError(response.data.error || '注册失败');\n        }\n      }\n    } catch (error) {\n      console.error('Authentication error:', error);\n      setError(error.response?.data?.error || '网络错误，请稍后重试');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleInputChange = (field, value) => {\n    // 清除错误信息\n    if (error) setError('');\n    \n    switch (field) {\n      case 'username':\n        setUsername(value);\n        break;\n      case 'password':\n        setPassword(value);\n        break;\n      case 'email':\n        setEmail(value);\n        break;\n      default:\n        break;\n    }\n  };\n\n  const togglePasswordVisibility = () => {\n    setShowPassword(!showPassword);\n  };\n\n  const switchMode = () => {\n    setIsLogin(!isLogin);\n    setError('');\n    setUsername('');\n    setPassword('');\n    setEmail('');\n  };\n\n  return (\n    <div className=\"login-container\">\n      {/* 背景装饰 */}\n      <div className=\"background-shapes\">\n        <div className=\"shape shape-1\"></div>\n        <div className=\"shape shape-2\"></div>\n        <div className=\"shape shape-3\"></div>\n        <div className=\"shape shape-4\"></div>\n        <div className=\"shape shape-5\"></div>\n      </div>\n\n      <div className=\"login-form\">\n        {/* 品牌标识 */}\n        <div className=\"brand-header\">\n          <div className=\"brand-icon\">\n            <svg viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n              <path d=\"M12 2L2 7V12C2 16.5 4.23 20.68 12 22C19.77 20.68 22 16.5 22 12V7L12 2Z\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n              <path d=\"M12 8V16\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n              <path d=\"M8 12H16\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n            </svg>\n          </div>\n          <h1 className=\"brand-title\">MindGuide</h1>\n          <p className=\"brand-subtitle\">您的心灵健康伙伴</p>\n        </div>\n\n        {/* 登录表单 */}\n        <form onSubmit={handleSubmit} className=\"form-container\">\n          <h2 className=\"form-title\">\n            {isLogin ? '欢迎回来' : '加入我们'}\n          </h2>\n          <p className=\"form-subtitle\">\n            {isLogin ? '登录您的账户继续治疗之旅' : '创建账户开始您的心灵疗愈'}\n          </p>\n\n          {error && (\n            <div className=\"error-message\">\n              <svg className=\"error-icon\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                <path fillRule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z\" clipRule=\"evenodd\" />\n              </svg>\n              {error}\n            </div>\n          )}\n\n          <div className=\"form-group\">\n            <label htmlFor=\"username\">用户名</label>\n            <div className=\"input-wrapper\">\n              <input\n                ref={usernameRef}\n                id=\"username\"\n                type=\"text\"\n                value={username}\n                onChange={(e) => handleInputChange('username', e.target.value)}\n                placeholder=\"请输入用户名\"\n                className=\"form-input\"\n                disabled={loading}\n              />\n              <svg className=\"input-icon\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                <path fillRule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clipRule=\"evenodd\" />\n              </svg>\n            </div>\n          </div>\n\n          <div className=\"form-group\">\n            <label htmlFor=\"password\">密码</label>\n            <div className=\"input-wrapper\">\n              <input\n                id=\"password\"\n                type={showPassword ? \"text\" : \"password\"}\n                value={password}\n                onChange={(e) => handleInputChange('password', e.target.value)}\n                placeholder=\"请输入密码\"\n                className=\"form-input\"\n                disabled={loading}\n              />\n              <svg className=\"input-icon\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                <path fillRule=\"evenodd\" d=\"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z\" clipRule=\"evenodd\" />\n              </svg>\n              <button\n                type=\"button\"\n                className=\"password-toggle\"\n                onClick={togglePasswordVisibility}\n                disabled={loading}\n              >\n                {showPassword ? (\n                  <svg viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                    <path d=\"M10 12a2 2 0 100-4 2 2 0 000 4z\" />\n                    <path fillRule=\"evenodd\" d=\"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z\" clipRule=\"evenodd\" />\n                  </svg>\n                ) : (\n                  <svg viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                    <path fillRule=\"evenodd\" d=\"M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-4.512 1.074l-1.78-1.781zm4.261 4.26l1.514 1.515a2.003 2.003 0 012.45 2.45l1.514 1.514a4 4 0 00-5.478-5.478z\" clipRule=\"evenodd\" />\n                    <path d=\"M12.454 16.697L9.75 13.992a4 4 0 01-3.742-3.741L2.335 6.578A9.98 9.98 0 00.458 10c1.274 4.057 5.065 7 9.542 7 .847 0 1.669-.105 2.454-.303z\" />\n                  </svg>\n                )}\n              </button>\n            </div>\n          </div>\n\n          {!isLogin && (\n            <div className=\"form-group\">\n              <label htmlFor=\"email\">邮箱 (可选)</label>\n              <div className=\"input-wrapper\">\n                <input\n                  id=\"email\"\n                  type=\"email\"\n                  value={email}\n                  onChange={(e) => handleInputChange('email', e.target.value)}\n                  placeholder=\"请输入邮箱\"\n                  className=\"form-input\"\n                  disabled={loading}\n                />\n                <svg className=\"input-icon\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                  <path d=\"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z\" />\n                  <path d=\"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z\" />\n                </svg>\n              </div>\n            </div>\n          )}\n\n          {isLogin && (\n            <div className=\"form-options\">\n              <label className=\"checkbox-label\">\n                <input\n                  type=\"checkbox\"\n                  checked={rememberMe}\n                  onChange={(e) => setRememberMe(e.target.checked)}\n                  disabled={loading}\n                />\n                <span className=\"checkbox-text\">记住我</span>\n              </label>\n              <a href=\"#\" className=\"forgot-link\">忘记密码？</a>\n            </div>\n          )}\n\n          <button\n            type=\"submit\"\n            disabled={loading}\n            className=\"submit-btn\"\n          >\n            {loading ? (\n              <div className=\"loading-spinner\">\n                <div className=\"spinner\"></div>\n                <span>处理中...</span>\n              </div>\n            ) : (\n              <span>{isLogin ? '登录' : '注册'}</span>\n            )}\n          </button>\n        </form>\n\n        {/* 切换登录/注册 */}\n        <div className=\"switch-mode\">\n          <p>\n            {isLogin ? '还没有账号？' : '已有账号？'}\n            <button\n              type=\"button\"\n              className=\"switch-btn\"\n              onClick={switchMode}\n              disabled={loading}\n            >\n              {isLogin ? '立即注册' : '立即登录'}\n            </button>\n          </p>\n        </div>\n\n        {/* 演示信息 */}\n        <div className=\"demo-info\">\n          <h4>演示账号</h4>\n          <div className=\"demo-accounts\">\n            <div className=\"demo-account\">\n              <strong>用户名:</strong> user1\n              <br />\n              <strong>密码:</strong> ph6n76gec9\n            </div>\n            <div className=\"demo-account\">\n              <strong>用户名:</strong> user2\n              <br />\n              <strong>密码:</strong> ph6n76gec9\n            </div>\n          </div>\n          <p className=\"demo-note\">\n            可使用 user1 到 user30 的任意账号进行测试\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Login;"]},"metadata":{},"sourceType":"module"}